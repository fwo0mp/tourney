// AUTO-GENERATED FILE. DO NOT EDIT.
// Generated by web/scripts/generate-e2e.mjs.

import { test, expect } from '../fixtures/e2e';

test("CASE-007: Team detail market maker midpoint spread and size propagation", async ({ page }) => {
  // Source markdown: e2e/cases/CASE-007-teamdetail-marketmaker-propagation.md

  // CASE-007 Step-1: Open Team Detail and choose Duke
  // Expected: Fill comparison and risk sections render.
  await page.goto("/");
  await page.getByTestId("dashboard-tab-teamdetail").click();
  await page.getByTestId("teamdetail-team-select").selectOption("Duke");
  await expect(page.getByTestId("teamdetail-fill-comparison")).toBeVisible();
  await expect(page.getByText("Bid Fill Delta Risk")).toBeVisible();
  await expect(page.getByText("Ask Fill Delta Risk")).toBeVisible();

  // CASE-007 Step-2: Set spread to 5.0 and midpoint to 3.00
  // Expected: Bid/ask fields and fill assumptions update to match new quote.
  await page.getByTestId("teamdetail-market-spread-input").fill("5.0");
  await expect(page.getByTestId("teamdetail-market-spread-input")).toHaveValue("5.0");
  await page.getByTestId("teamdetail-market-midpoint-input").fill("3.00");
  await expect(page.getByTestId("teamdetail-market-bid-input")).toHaveValue("2.92");
  await expect(page.getByTestId("teamdetail-market-ask-input")).toHaveValue("3.08");
  await expect(page.getByTestId("teamdetail-fill-assumption-bid")).toContainText("+5,000 shares @ 2.92");
  await expect(page.getByTestId("teamdetail-fill-assumption-ask")).toContainText("-5,000 shares @ 3.08");

  // CASE-007 Step-3: Adjust sizes to 4200 bid and 3600 ask
  // Expected: Fill assumptions and risk subtitles reflect updated quantities.
  await page.getByTestId("teamdetail-market-bid-size-input").fill("4200");
  await page.getByTestId("teamdetail-market-ask-size-input").fill("3600");
  await expect(page.getByTestId("teamdetail-fill-assumption-bid")).toContainText("+4,200 shares @ 2.92");
  await expect(page.getByTestId("teamdetail-fill-assumption-ask")).toContainText("-3,600 shares @ 3.08");
  await expect(page.getByText("How team deltas change if your bid fully fills (+4,200 shares).")).toBeVisible();
  await expect(page.getByText("How team deltas change if your ask fully fills (-3,600 shares).")).toBeVisible();

  // CASE-007 Step-4: Enter invalid bid/ask (bid >= ask)
  // Expected: Submit disables and placeholder replaces fill comparison.
  await page.getByTestId("teamdetail-market-bid-input").fill("3.50");
  await page.getByTestId("teamdetail-market-ask-input").fill("3.40");
  await expect(page.getByTestId("teamdetail-market-submit")).toBeDisabled();
  await expect(page.getByTestId("teamdetail-market-summary")).toContainText("Invalid: bid must be less than ask");
  await expect(page.getByTestId("teamdetail-fill-placeholder")).toBeVisible();

});
